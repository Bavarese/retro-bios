
;-- INT 13 -------------------------------------------------------------
; DISKETTE I/O
;       ЭТОТ ИНТЕРФЕЙС ОБЕСПЕЧИВАЕТ ДОСТУП К  5.25 ДЮЙМОВОМУ 360 KB,
;       1.2MB,720 KB, AND 1.44 MB ДИСКОВОДУ
; ВХОД
;       (AH)=OOH  СБРОС ДИСКОВОЙ СИСТЕМЫ
;        АППОРАТНЫЙ СБРОС NEC, ПОДГОТОВИТЕЛЬНАЯ КОМАНДА
;----------------------------------------------------------------------------
;       (AH)=01H  ЧТЕНИЕ СТАТУСА СИСТЕМЫ В (AH)
;                 DISKETTE_STATUS ПОСЛЕДНЕЙ ДИСКОВОЙ ОПЕРАЦИИ
;----------------------------------------------------------------------------
;       РЕГИСТРЫ ДЛЯ ЧТЕНИЯ/ЗАПИСИ/ВЕРИФИКАЦИИ
;       (DL) - НОМЕР ДИСКОВОДА (0-1 , ЗНАЧЕНИЕ ПРОВЕРЯЕТСЯ)
;       (DH) - НОМЕР ГОЛОВКИ (0-1 ALLOWED, NOT VALUE CHECKED)
;       (CH) - НОМЕР ДОРОЖКИ (NOT VALUE CHECKED)
;                 MEDIA     DRIVE        TRACK NUMBER
;                320/360   320/360           0-39
;                320/360    1.2M             0-39
;                 1.2M      1.2M             0-79
;                 720K      720K             0-79
;                 1.44M     1.44M            0-79
;       (CL) - НОМЕР СЕКТОРА (ЗНАЧЕНИЕ НЕ ПРОВЕРЯЕТСЯ, НЕ ИСПОЛЬЗУЕТСЯ ПРИ
;                            ФОРМАТИРОВАНИИ)
;                 MEDIA     DRIVE        SECTOR NUMBER
;                320/360   320/360            1-8/9
;                320/360    1.2M              1-8/9
;                 1.2M      1.2M              1-15
;                 720K      720K              1-9
;                 1.44M     1.44M             1-18
;       (AL) - ЧИСЛО СЕКТОРОВ (ЗНАЧЕНИЕ НЕ ПРОВЕРЯЕТСЯ, НЕ ИСПОЛЬЗУЕТСЯ ПРИ
;			      ФОРМАТИРОВАНИИ)
;                 MEDIA     DRIVE        MAX NUMBER OF SECTORS
;                320/360   320/360               8/9
;                320/360    1.2M                 8/9
;                 1.2M      1.2M                 15
;                 720K      720K                  9
;                 1.44M     1.44M                18
;
;       (ES:BX) - АДРЕСС БУФФЕРА (НЕ ИСПОЛЬЗУЕТСЯ ПРИ ВЕРИФИКАЦИИ)
;
;---------------------------------------------------------------------------
;       (AH)=02H  ЧТЕНИЕ УКАЗАННОГО СЕКТОРА В ПАМЯТЬ
;----------------------------------------------------------------------------
;       (AH)=03H  ЗАПИСЬ УКАЗАННОГО СУКТОРА В ПАМЯТЬ
;----------------------------------------------------------------------------
;       (AH)=04H  ВЕРИФИКАЦИЯ УКАЗАННОГО СЕКТОРА
;----------------------------------------------------------------------------
;       (AH)=05H  ФОРМАТИРОВАНИЕ УКАЗАННОГО СЕКТОРА
;                 (ES,BX) ДОЛЖЕН УКАЗЫВАТЬ НА ОБЛАСТЬ ДАННЫХ ПАРАМЕТРОВ
;                 ДИСКЕТЫ . КАЖДАЯ ОБЛАСТЬ ВКЛЮЧАЕТ 4 БАЙТА  (C,H,R,N),
;                 ГДЕ:
;                 C = ЧИСЛО ДОРОЖЕК, H=ЧИСЛО ГОЛОВОК, R = ЧИСЛО СЕКТОРОВ,
;		  N= ЧИСЛО БАЙТ НА СЕКТОР (00=128, 01=256, 02=512, 03=1024,)
;                 ПРОЦЕДУРА ФОРМАТИРОВАНИЯ ДОПУСКАЕТ
;                 УСТАНОВКУ ФОРМАТА МАКСИМАЛЬНОЙ ПЛОТНОСТИ ДЛЯ ДАННОГО ДИСКОВОДА
;                 ПАРАМЕТРЫ DISK_BASE ДОЛЖНЫ БЫТЬ РАСПОЛОЖЕНЫ В ПОРЯДКЕ
;                 -------------------------------------------
;                 : MEDIA  :  DRIVE         : PARM1 : PARM2 :
;                 -------------------------------------------
;                 : 320K   : 320K/360K/1.2M :  50H  :   8   :
;                 : 360K   : 320K/360K/1.2M :  50H  :   9   :
;                 : 1.2M   :    1.2M        :  54H  :  15   :
;                 : 720K   :  720K/1.44M    :  50H  :   9   :
;                 : 1.44M  :  1.44M         :  6CH  :  18   :
;                 -------------------------------------------
;                 ЗАМЕТИМ:-PARM 1=ПРОМЕЖУТОК ДЛЯ ФОРМАТА
;                         -PARM 2=EOT (ПОСЛЕДНИЙ СЕКТОР В ТРЕКЕ)
;                         -DISK_BASE ЭТО УКАЗАТЕЛЬ НА ОБЛАСТЬ РАСПОЛОЖЕНИЯ
;                          ПАРАМЕТРОВ ДИСКА С АБСОЛЮТНЫМ АДРЕСОМ 0:78
;------------------------------------------------------------------------------
;       (AH)=08H ЧТЕНИЕ ПАРАМЕТРОВ ДИСКОВОДА
;         INPUT
;           (DL)-НОМЕР ДИСКОВОДА (0-1 ЗНАЧЕНИЕ ПРОВЕРЯЕТСЯ)
;         OUTPUT
;           (ES:DI) УКАЗАТЕЛЬ НА ТАБЛИЦУ ПАРАМЕТРОВ
;           (CH)-МАКСИМАЛЬНЫЙ НОМЕР ДОРОЖКИ (МЛАДШИЕ 8 БИТ)
;           (CL)-МАКСИМАЛЬНЫЙ НОМЕР СЕКТОРА(И СТАРШИЕ БИТЫ МАКСИМАЛЬНОГО
;		 НОМЕРА ДОРОЖКИ
;           (DH)-МАКСИМАЛЬНЫЙ НОМЕР ГОЛОВКИ
;------------------------------------------------------------------------------
;15H ▌AT▐ Читать тип диска (недоступна в XT BIOS)
;     Вход: DL = диск
;    Выход: AH = код устройства:
;                0 = устройство DL отсутствует
;                1 = дискета; логика замены диска отсутствует
;                2 = дискета; логика замены диска доступна (большинство случаев)
;                3 = твердый диск
;▀▀▀ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
;16H ▌AT▐ Читать статус замены диска
;    Выход: AH = код статуса:
;                0 = диск не был заменен
;                6 = замена активна (открыта дисковая дверь);
;                    DL = номер заменяемого диска
;▀▀▀ ▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀▀
;17H ▌AT▐ установить тип дискеты (используется перед операцией форматирования)
;     Вход: DL = номер устройства диска (0 или 1)
;           AL = тип носителя диска:
;                0 = не используется
;                1 = 360K дискета в 360K устройстве
;                2 = 360K дискета в 1.2M устройстве
;                3 = 1.2M дискета в 1.2M устройстве
;───────────────────────────────────────────────────────────────────────────────
;       (AH)=18H УСТАНОВКА ТИПА ДЛЯ ФОРМАТИРОВАНИЯ
;       ВХОДНЫЕ РЕГИСТРЫ
;       (CH) - С 8 ПО 10 БИТЫ - МЛАДШИЕ БИТЫ МАКСИМАЛЬНОГО ЧИСЛА ДОРОЖЕК
;       (CL) - БИТЫ 7 И 6 - СТАРШИЕ ДВА БИТА МАКСИМАЛЬНОГО ЧИСЛА ДОРОЖЕК
;            - БИТЫ 5 - 0 -МАКСИМАЛЬНОЕ ЧИСЛО СЕКТОРОВ НА ДОРОЖКЕ
;       (DL) - НОМЕР ДИСКОВОДА (0-1 ЗНАЧЕНИЕ ПРОВЕРЯЕТСЯ)
;       ВЫХОДНЫЕ РЕГИСТРЫ
;       (ES:DI) - УКАЗАТЕЛЬ НА ТАБЛИЦУ ПАРАМЕТРОВ ЭТОГО ТИПА ДИСКЕТ,
;		  ЕСЛИ AH НУЛЕВОЕ
;       (AH) - 00H, CY=0 ,ЭТИ ПАРАМЕТРЫ ПОДДЕРЖИВАЮТСЯ
;              01H, CY=1 ,ЭТА ФУНКЦИЯ НЕ ДОСТУПНА
;              0CH, CY=1 ,ЭТИ ПАРАМЕТРЫ НЕ ПОДДЕРЖИВАЮТСЯ
;                         ИЛИ НЕИЗВЕСТНЫЙ ТИП
;            - 80H, CY=1 ,TIME OUT (ДИСКЕТТА НЕ ПРИСУТСТВУЕТ)
;-----------------------------------------------------------------------------
;
;    СОСТОЯНИЯ ДИСКА - АБСОЛЮТНЫЙ АДРЕСС 40:90 (ДИСКОВОД A) И 91 (ДИСКОВОД B)
;
;   -----------------------------------------------------------------
;   |       |       |       |       |       |       |       |       |
;   |   7   |   6   |   5   |   4   |   3   |   2   |   1   |   0   |
;   |       |       |       |       |       |       |       |       |
;   -----------------------------------------------------------------
;       |       |       |       |       |       |       |       |
;       |       |       |       |       |       -----------------
;       |       |       |       |       |               |
;       |       |       |       |    РЕЗЕРВ             --ТЕКУЩЕЕ СОСТОЯНИЕ
;       |       |       |       |
;       |       |       |       |        000: 360K В 360K ДИСКОВОД НЕ УСТАНОВЛЕН
;       |       |       |       |        001: 360K В 1.2M ДИСКОВОД НЕ УСТАНОВЛЕН
;       |       |       |       |        010: 1.2M В 1.2M ДИСКОВОД НЕ УСТАНОВЛЕН
;       |       |       |       |        011: 360K В 360K ДИСКОВОД УСТАНОВЛЕН
;       |       |       |       |        100: 360K В 1.2M ДИСКОВОД УСТАНОВЛЕН
;       |       |       |       |        101: 1.2M В 1.2M ДИСКОВОД УСТАНОВЛЕН
;       |       |       |       |        110: РЕЗЕРВ
;       |       |       |       |        111: НЕ БОЛЬШЕ
;       |       |       |       |
;       |       |       |       ------> ДИСКЕТА/ДИСКОВОД УСТАНОВЛЕНЫ
;       |       |       |
;       |       |       --------------> ДВОЙНОЙ ШАГ 360K В 1.2M
;       |       |
;       |       |
;       ------------------------------> СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ ДЛЯ ЭТОГО ДИСКОВОДА
;
;                                               00: 500 KBS
;                                               01: 300 KBS
;                                               10: 250 KBS
;                                               11: РЕЗЕРВ
;--------------------------------------------------------------------------------

        ORG     0EC59H

DISKETTE_IO     PROC    FAR
        STI
        PUSH    BP
        PUSH    DI
        PUSH    DX
        PUSH    BX
        PUSH    CX
        MOV     BP,SP
        PUSH    DS
        PUSH    SI
        CALL    DDS

        MOV	LowLim,AX
        MOV	UPPP,055H
REPID_YES:        
	not	uppp
        CMP     AH,19H
                                        ; ПРОВЕРКА  19H ФУНКЦИИ
        JB      OK_FUNC
        MOV     AH,14H
OK_FUNC:
        CMP     AH,1                    ; ПРОВЕРКА 1 И 8 ФУНКЦИЙ
        JBE     OK_DRV                  ;
        CMP     AH,8                    ;
        JE      OK_DRV                  ;
        CMP     DL,1                    ;
        JBE     OK_DRV                  ;
        MOV     AH,14H                  ;
OK_DRV :
        MOV     CL,AH                   ; ВЫЧИСЛЕНИЕ АДРЕСА ВЫПОЛНЯЕМОЙ ФУНКЦИИ
        XOR     CH,CH                   ;
        SHL     CL,1                    ;
        MOV     BX,OFFSET FNC_TAB       ;
        ADD     BX,CX                   ;
        MOV     AH,DH                   ;
        XOR     DH,DH                   ;
        MOV     SI,AX                   ;
        MOV     DI,DX                   ;
        MOV     AH,DISKETTE_STATUS      ; ОБНУЛЕНИЕ DISKETTE_STATUS
        MOV     DISKETTE_STATUS,0       ;

;       ДЛЯ ВСЕХ ФУНКЦИЙ БИОС СЛУЖЕБНАЯ ИНФОРМАЦИЯ СОДЕРЖИТСЯ В РЕГИСТРАХ И В
;       ОБЛАСТЯХ ПАМЯТИ. НЕ ВСЕ ФУНКЦИИ ТРЕБУЮТ ПОЛНОГО ИСПОЛЬЗОВАНИЯ ВСЕХ ПАРА
;       МЕТРОВ
;
;               DI      : ДИСКОВОД #
;               SI-HI   : ГОЛОВКА  #
;               SI-LOW  : # СЕКТОРОВ ИЛИ ТИП DASD ДЛЯ ФОРМАТИРОВАНИЯ
;               ES      : СЕГМЕНТ БУФЕРА
;               [BP]    : СЕКТОР #
;               [BP+1]  : ДОРОЖКА #
;               [BP2]   : BUFFER OFFSET
;
                                        ;
        CALL    WORD PTR CS:[BX]        ; ПЕРЕХОД НА НЕОБХОДИМУЮ ФУНКЦИЮ
        JNC	EXIT_OP
        CMP	UPPP,0AAH
        JNE	EXIT_OP
        MOV	AX,LowLim
        MOV	CX,[BP]
        MOV	BX,[BP+2]
        MOV	DX,[BP+4]
        JMP	REPID_YES
EXIT_OP:               
        POP     SI                      ;
        POP     DS
        POP     CX
        POP     BX
        POP     DX
        POP     DI
        MOV     BP,SP
        PUSH    AX
        PUSHF
        POP     AX
        MOV     [BP+6],AX
        POP     AX
        POP     BP
        IRET
;----------------------------------------------------------------------------
FNC_TAB DW      DISK_RESET              ; AH = 00H; СБРОС
        DW      DISK_STATUS             ; AH = 01H; СТАТУС
        DW      DISK_READ               ; AH = 02H; ЧТЕНИЕ
        DW      DISK_WRITE              ; AH = 03H; ЗАПИСЬ
        DW      DISK_VERF               ; AH = 04H; ВЕРИФИКАЦИЯ
        DW      DISK_FORMAT             ; AH = 05H; ФОРМАТИРОВАНИЕ
        DW      FNC_ERR                 ; AH = 06H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 07H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      DISK_PARMS              ; AH = 08H; ЧТЕНИЕ ПАРАМЕТРОВ ДИСКОВОДА
        DW      FNC_ERR                 ; AH = 09H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0AH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0BH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0CH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0DH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0EH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 0FH; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 10H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 11H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 12H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 13H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      FNC_ERR                 ; AH = 14H; НЕ ПОДДЕРЖИВАЕТСЯ
        DW      DISK_TYPE               ; AH = 15H; ЧТЕНИЕ DASD ТИПА
        DW      DISK_CHANGE             ; AH = 16H; СМЕНА СТАТУСА
        DW      FORMAT_SET              ; AH = 17H; УСТАНОВКА DASD ТИПА
        DW      SET_MEDIA               ; AH = 18H; УСТАНОВКА ТИПА ДИСКЕТЫ
FNC_TAE EQU     $                       ; КОНЕЦ
DISKETTE_IO     ENDP

MD_STRUC        STRUC
MD_SPEC1        DB      ?       ; SRT=D,HD UNLOAD=OF -IST SPECIFY BYTE
MD_SPEC2        DB      ?       ; HD LOAD=1,MODE=DMA -2ND SPECIFY BYTE
MD_OFF_TIM      DB      ?       ; ОЖИДАНИЕ ПОСЛЕ ВКЛЮЧЕНИЯ МОТОРА         
MD_BYT_SEC      DB      ?       ; 512 БАЙТ/СЕКТОР
MD_SEC_TRK      DB      ?       ; EQT (ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)
MD_GAP          DB      ?       ; ПРОМЕЖУТОК МЕЖДУ ЗАПИСЯМИ
MD_DTL          DB      ?       ; DTL
MD_GAP3         DB      ?       ; ПРОМЕЖУТОК ДЛЯ ФОРМАТИРОВАНИЯ
MD_FIL_BYT      DB      ?       ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ
MD_HD_TIM       DB      ?       ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)
MD_STR_TIM      DB      ?       ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)
MD_MAX_TRK      DB      ?       ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК
MD_RATE         DB      ?       ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ
MD_STRUC        ENDS

TYPEDSK		EQU	42h    ;43H     ; ВРЕМЕННО НАЗНАЧЕНО !!! A=720K  B=1.44M

BIT7OFF         EQU     7FH
BIT7ON          EQU     80H

;--------- DISKETTE ERRORS-

MED_NOT_FND     EQU     00CH            ;ТИП ДИСКЕТЫ НЕ ОПРЕДЕЛЕН

;----------НОСИТЕЛЬ/ДИСКОВОД ИНДИКАТОРЫ СОСТОЯНИЯ

TRK_CAPA        EQU     00000001B       ;80 ДОРОЖЕЧНЫЙ    
FMT_CAPA        EQU     00000010B       ;МНОГОСКОРОСТНОЙ (1.2MB)
DRV_DET         EQU     00000100B       ;БИТ ОПРЕДЕЛЕНИЯ ДИСКОВОДА
MED_DET         EQU     00010000B       ;БИТ ОПРЕДЕЛЕНИЯ ДИСКЕТЫ
DBL_STEP        EQU     00100000B       ;БИТ ОПРЕДЕЛЕНИЯ ДИСКЕТЫ
RATE_MSK        EQU     11000000B       ;МАСКА ДЛЯ ОЧИСТКИ ВСЕХ БИТ СКОРОСТИ
RATE_250        EQU     10000000B       ;250 KBS СКОРОСТЬ ПЕРЕДАЧИ
RATE_300        EQU     01000000B       ;300 KBS СКОРОСТЬ ПЕРЕДАЧИ
RATE_500        EQU     00000000B       ;500 KBS СКОРОСТЬ ПЕРЕДАЧИ
STRT_MSK        EQU     00001100B       ;МАСКА СТАРТОВОЙ СКОРОСТИ 
SEND_MSK        EQU     11000000B       ;МАСКА ДЛЯ ПОСЫЛКИ БИТ СКОРОСТИ

;----------НОСИТЕЛЬ/ДИСКОВОД ИНДИКАТОРЫ СОВМЕСТИМОСТИ

M3D3U           EQU     00000000B       ;360 НОСИТЕЛЬ/ДИСКОВОД НЕ УСТАНОВЛЕН
M3D1U           EQU     00000001B       ;360 НОСИТ,1.2ДИСКОВОД НЕ УСТАНОВЛЕН
M1D1U           EQU     00000010B       ;1.2 НОСИТЕЛЬ/ДИСКОВОД НЕ УСТАНОВЛЕН
MED_UNK         EQU     00000111B       ;НИКТО НЕ БОЛЬШЕ  

;----------CMOS ТАБЛИЦА РАСПОЛОЖЕНИЯ

CMOS_DIAG       EQU     00EH            ;БАЙТ ДИАГНОСТИКИ                   
CMOS_DISKETTE   EQU     010H            ;ТИПЫ ДИСКОВОДОВ         



;------------------------------------------------------------------------------
;       ТАБЛИЦЫ ТИПОВ ДИСКОВОДОВ
;----------------------------------------------------------------------------
DR_TYPE         DB      01              ; ПЕРВЫЙ ТИП            
                DW      OFFSET MD_TBL1
                DB      02+BIT7ON
                DW      OFFSET MD_TBL2
DR_DEFAULT      DB      02
                DW      OFFSET MD_TBL3
                DB      03
                DW      OFFSET MD_TBL4
                DB      04+BIT7ON
                DW      OFFSET MD_TBL5
                DB      04
                DW      OFFSET MD_TBL6
DR_TYPE_E       =$                      ; КОНЕЦ ТАБЛИЦЫ
DR_CNT          EQU     (DR_TYPE_E-DR_TYPE)/3
;--------------------------------------------------------------------------
;       НОСИТЕЛЬ/ДИСКОВОД ТАБЛИЦЫ ПАРАМЕТРОВ                              :
;--------------------------------------------------------------------------
;--------------------------------------------------------------------------
;       360 KB НОСИТЕЛЬ В 360 ДИСКОВОДЕ                                   :
;--------------------------------------------------------------------------
MD_TBL1         LABEL BYTE
        DB      11011111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ     
        DB      2               ; 512 БАЙТ НА СЕКТОР
        DB      09              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)
        DB      02AH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ
        DB      0FFH            ; DTL
        DB      050H            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ   
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД) 
        DB      39              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК           
        DB      RATE_250        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ             
;------------------------------------------------------------------------------
;       360 KB НОСИТЕЛЬ 1.2 MB ДИСКОВОД                                    :
;-----------------------------------------------------------------------------
MD_TBL2         LABEL BYTE
        DB      11011111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE    
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE    
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ    
        DB      2               ; 512 БАЙТ НА СЕКТОР                     
        DB      09              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)     
        DB      02AH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ              
        DB      0FFH            ; DTL                                    
        DB      050H            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ          
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ     
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)  
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)   
        DB      39              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК             
        DB      RATE_300        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ               
;----------------------------------------------------------------------------
;       1.2 MB НОСИТЕЛЬ 1.2 MB ДИСКОВОД                                    :
;---------------------------------------------------------------------------
MD_TBL3         LABEL BYTE
        DB      11011111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE    
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE    
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ    
        DB      2               ; 512 БАЙТ НА СЕКТОР                     
        DB      15              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)     
        DB      01BH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ              
        DB      0FFH            ; DTL                                    
        DB      054H            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ          
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ     
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)  
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)   
        DB      79              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК             
        DB      RATE_500        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ               
;-----------------------------------------------------------------------------
;       720 KB НОСИТЕЛЬ 720 KB ДИСКОВОД                                       :
;-----------------------------------------------------------------------------
MD_TBL4         LABEL BYTE
        DB      11011111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE    
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE    
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ    
        DB      2               ; 512 БАЙТ НА СЕКТОР                     
        DB      09              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)     
        DB      02AH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ              
        DB      0FFH            ; DTL                                    
        DB      050H            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ          
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ     
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)  
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)   
        DB      79              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК             
        DB      RATE_250        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ               
;----------------------------------------------------------------------------
;       720 KB НОСИТЕЛЬ 1.44 MB ДИСКОВОД                                     :
;----------------------------------------------------------------------------

MD_TBL5         LABEL BYTE
        DB      11011111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE    
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE    
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ    
        DB      2               ; 512 БАЙТ НА СЕКТОР                     
        DB      09              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)     
        DB      02AH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ              
        DB      0FFH            ; DTL                                    
        DB      050H            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ          
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ     
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)  
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)   
        DB      79              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК             
        DB      RATE_250        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ               
;----------------------------------------------------------------------------
;       1.44 MB НОСИТЕЛЬ 1.44 MB ДИСКОВОД                                   :
;----------------------------------------------------------------------------

MD_TBL6         LABEL BYTE
        DB      10101111B       ; SRT=D,HD UNLOAD=OF-1ST SPECIFY BYTE    
        DB      2               ; HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE    
        DB      MOTOR_WAIT      ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ    
        DB      2               ; 512 БАЙТ НА СЕКТОР                     
        DB      18              ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)     
        DB      01BH            ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ              
        DB      0FFH            ; DTL                                    
        DB      06CH            ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ          
        DB      0F6H            ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ     
        DB      15              ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)  
        DB      8               ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД)   
        DB      79              ; МАКСИМАЛЬНОЕ ЧИСЛО ДОРОЖЕК             
        DB      RATE_500        ; СКОРОСТЬ ПЕРЕДАЧИ ДАННЫХ               

;-------------------------------------------------------------------------
;DISK_BASE
;       ЭТА ТАБЛИЦА СОДЕРЖИТ ПАРАМЕТРЫ НЕОБХОДИМЫЕ ДЛЯ
;       ДИСКЕТНЫХ ОПЕРАЦИЙ.НА НЕЕ УКАЗЫВАЕТ DISK_POINTER
;       ДЛЯ МОДИФИКАЦИИ ПАРАМЕТРОВ НЕОБХОДИМО ПОСТРОИТЬ СВОЮ
;       ТАБЛИЦУ И ЗАГРУЗИТЬ УКАЗАТЕЛЬ НА НЕЕ В DISK_POINTER      
;-------------------------------------------------------------------------
        ORG     0EFC7H
DISK_BASE       LABEL  BYTE
        DB      10011111B     ;SRT=9,HD UNLOAD=0F-IST SPECIFY BYTE
        DB      2             ;HD LOAD=1,MODE=DMA-2ND SPECIFY BYTE
        DB      MOTOR_WAIT    ; ВРЕМЯ РАБОТЫ МОТОРА ПОСЛЕ ВКЛЮЧЕНИЯ  
        DB      2             ; 512 БАЙТ НА СЕКТОР                   
        DB      18            ; EOT ( ПОСЛЕДНИЙ СЕКТОР НА ДОРОЖКЕ)   
        DB      02AH          ; РАССТОЯНИЕ МЕЖДУ ЗАПИСЯМИ            
        DB      0FFH          ; DTL                                  
        DB      050H          ; РАССТОЯНИЕ ДЛЯ ФОРМАТИРОВАНИЯ        
        DB      0F6H          ; БАЙТ ЗАПОЛНЕНИЯ ДЛЯ ФОРМАТИРОВАНИЯ   
        DB      25            ; ВРЕМЯ УСТАНОВКИ ГОЛОВКИ (МИЛЛИСЕКУНД)
        DB      4             ; ВРЕМЯ ВКЛЮЧЕНИЯ МОТОРА ( 1/8 СЕКУНД) 

