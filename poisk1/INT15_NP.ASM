;--------------------------------------------------------------------------- 
READ_HALF_BIT   PROC    NEAR 
; γεμψ: 
;  χωώισμρετ δμιτεμψξοστψ πομυπεςιοδα βιτα, 
;  τ.ε. δμιτεμψξοστψ ιξτεςχαμα οτ οδξοκ σνεξω υςοχξρ 
;  σιηξαμα δο δςυηοκ 
; 
; ξα χθοδε: 
;  EDGE_CNT σοδεςφιτ ϊξαώεξιε σώετώιλα τακνεςα χ νονεξτ σνεξω υςοχξρ σιηξαμα 
; 
; ON EXIT: 
;  AX σοδεςφιτ ϊξαώεξιε σώετώιλα χ νονεξτ ξοχοκ σνεξω υςοχξρ 
;  BX σοδεςφιτ δμιτεμψξοστψ πομυπεςιοδα 
;---------------------------------------------------------------------------- 
        MOV     CX,100                  ;υσταξοχιτψ χςενρ οφιδαξιρ ζςοξτα 
        MOV     AH,LAST_VAL             ;AH <-- τελυύικ υςοχεξψ σιηξαμα 
W22:                                    ;ώιτατψ πομυβιτ 
        IN      AL,PORT_C               ;χχεστι σιηξαμ σ ναηξιτοζοξα 
        AND     AL,010H          ;χωδεμιτψ τςεβυενωκ βιτ 
        CMP     AL,AH                   ;υςοχεξψ πονεξρμσρ? 
        LOOPE   W22                     ;εσμι ξετ, ποχτοςιτψ 
        MOV     LAST_VAL,AL             ;σοθςαξιτψ ξοχωκ υςοχεξψ 
        MOV     AL,0                    ;ώιταεν τακνες ξα μετυ 
        OUT     TIM_CTL,AL 
        IN      AL,TIMER0               ;νμαδϋικ βακτ 
        MOV     AH,AL                   ;σοθςαξρεν χ AH 
        IN      AL,TIMER0               ;σταςϋικ βακτ 
        XCHG    AL,AH                   ;XCHG AL,AH 
        MOV     BX,EDGE_CNT             ;BX <-- πςεδωδυύεε ϊξαώεξιε σώετώιλα 
        SUB     BX,AX                   ;BX <-- δμιτεμψξοστψ πομυπεςιοδα 
        MOV     EDGE_CNT,AX             ;σοθςαξρεν ϊξαώεξιε σώετώιλα 
        RET 
READ_HALF_BIT   ENDP 
 
BREAK_TEST      PROC    NEAR 
;---------------------------------------------------------------------------- 
;  γεμψ: 
;       οπςοσ λμαχιατυςω ξα πςεδνετ ξαφατιρ λμαχιϋ 
;       ESC,TAB ιμι CTRL δμρ πςεςωχαξιρ ώτεξιρ λασσετω 
; 
;       εσμι εστψ ξαφατιε οδξοκ ιϊ ότιθ λμαχιϋ - ζμαη Z=1 
;---------------------------------------------------------------------------- 
        PUSH    AX                      ;σοθςαξιτψ AX 
        MOV     AL,0FFH 
        OUT     60H,AL 
        IN      AX,69H                  ;οπςοσιτψ ποςτ λμαχιατυςω 
        AND     AX,080H                  ;εσμι ξαφατα λμαχιϋα Z<--1 
        POP     AX                      ;χοσσταξοχιτψ AX 
        RET 
BREAK_TEST      ENDP 
 
 
